# ============================================================
# NetAudit - Netbox Bootstrap Configuration
# ============================================================
# Este archivo define los objetos base que se crean
# autom√°ticamente en Netbox en la primera ejecuci√≥n
# ============================================================

version: "1.1"
bootstrap_once: true  # Solo ejecutar si no existen objetos

# ============================================================
# SITES (Ubicaciones f√≠sicas)
# ============================================================
sites:
  - name: "HomeLab"
    slug: "homelab"
    description: "Red dom√©stica principal"
    status: "active"
    # Opcional: coordenadas GPS
    # latitude: -33.4489
    # longitude: -70.6693

# ============================================================
# MANUFACTURERS (Fabricantes)
# ============================================================
manufacturers:
  - name: "Generic"
    slug: "generic"
    description: "Fabricante gen√©rico para dispositivos sin identificar"

# ============================================================
# DEVICE TYPES (Tipos de dispositivos)
# ============================================================
# manufacturer_slug: slug del fabricante (debe existir arriba)
device_types:
  - model: "Router"
    slug: "router"
    manufacturer_slug: "generic"
    
  - model: "Switch"
    slug: "switch"
    manufacturer_slug: "generic"
    
  - model: "Access Point"
    slug: "access-point"
    manufacturer_slug: "generic"
    
  - model: "Server"
    slug: "server"
    manufacturer_slug: "generic"
    
  - model: "NAS"
    slug: "nas"
    manufacturer_slug: "generic"
    
  - model: "Computer"
    slug: "computer"
    manufacturer_slug: "generic"
    
  - model: "Laptop"
    slug: "laptop"
    manufacturer_slug: "generic"
    
  - model: "Smart TV"
    slug: "smart-tv"
    manufacturer_slug: "generic"
    
  - model: "IoT Device"
    slug: "iot-device"
    manufacturer_slug: "generic"
    
  - model: "Mobile Device"
    slug: "mobile-device"
    manufacturer_slug: "generic"
    
  - model: "Printer"
    slug: "printer"
    manufacturer_slug: "generic"
    
  - model: "IP Camera"
    slug: "ip-camera"
    manufacturer_slug: "generic"
    
  - model: "Network Device"
    slug: "network-device"
    manufacturer_slug: "generic"
    
  - model: "Unknown"
    slug: "unknown"
    manufacturer_slug: "generic"

# ============================================================
# DEVICE ROLES (Roles/funciones de dispositivos)
# ============================================================
# color: formato hexadecimal sin #
device_roles:
  - name: "Infrastructure"
    slug: "infrastructure"
    color: "ff5722"
    description: "Routers, switches, access points"
    
  - name: "Service"
    slug: "service"
    color: "2196f3"
    description: "Servers, NAS, servicios de red"
    
  - name: "Workstation"
    slug: "workstation"
    color: "4caf50"
    description: "PCs, laptops, estaciones de trabajo"
    
  - name: "Entertainment"
    slug: "entertainment"
    color: "9c27b0"
    description: "TVs, consolas, media devices"
    
  - name: "IoT"
    slug: "iot"
    color: "ff9800"
    description: "Dispositivos IoT, dom√≥tica, sensores"
    
  - name: "Mobile"
    slug: "mobile"
    color: "00bcd4"
    description: "Smartphones, tablets"
    
  - name: "Peripheral"
    slug: "peripheral"
    color: "795548"
    description: "Impresoras, scanners, perif√©ricos"
    
  - name: "Unknown"
    slug: "unknown"
    color: "9e9e9e"
    description: "Dispositivos sin clasificar"

# ============================================================
# TAGS (Etiquetas para categorizaci√≥n)
# ============================================================
tags:
  # Tags de categor√≠as funcionales
  - name: "Domotica"
    slug: "domotica"
    color: "ff9800"
    description: "Dispositivos de dom√≥tica y smart home"
    
  - name: "Trabajo"
    slug: "trabajo"
    color: "2196f3"
    description: "Dispositivos relacionados con trabajo"
    
  - name: "Entretenimiento"
    slug: "entretenimiento"
    color: "9c27b0"
    description: "Dispositivos de entretenimiento"
    
  - name: "ISP"
    slug: "isp"
    color: "f44336"
    description: "Dispositivos del proveedor de internet"
    
  - name: "Infrastructure"
    slug: "infrastructure"
    color: "ff5722"
    description: "Infraestructura de red"
  
  # ============================================================
  # TAGS DE ESCANEO POR FASES - Sistema de 5 fases
  # ============================================================
  # Estos tags permiten rastrear el progreso del escaneo incremental
  
  # FASE 0: Estado inicial
  - name: "üîç Pendiente Escaneo"
    slug: "pendiente-escaneo"
    color: "9e9e9e"
    description: "IP registrada pero sin escanear"
  
  # FASE 1: Descubrimiento de IP
  - name: "‚úÖ Fase 1: IP Viva"
    slug: "fase-1-ip-viva"
    color: "4caf50"
    description: "Host detectado como activo (ping/ARP)"
  
  # FASE 2: Detecci√≥n de puertos TCP
  - name: "üîå Fase 2: Puertos TCP"
    slug: "fase-2-puertos-tcp"
    color: "03a9f4"
    description: "Puertos TCP detectados"
  
  # FASE 3: Detecci√≥n de puertos UDP
  - name: "üîå Fase 3: Puertos UDP"
    slug: "fase-3-puertos-udp"
    color: "00bcd4"
    description: "Puertos UDP detectados"
  
  # FASE 4: Identificaci√≥n de servicios
  - name: "‚öôÔ∏è Fase 4: Servicios"
    slug: "fase-4-servicios"
    color: "9c27b0"
    description: "Servicios identificados en puertos"
  
  # FASE 5: Auditor√≠a completa
  - name: "üéØ Fase 5: Completado"
    slug: "fase-5-completado"
    color: "4caf50"
    description: "Escaneo completo (OS, MAC, hostname, fingerprinting)"
  
  # Estados especiales
  - name: "‚ö†Ô∏è Error Escaneo"
    slug: "error-escaneo"
    color: "f44336"
    description: "Error durante alguna fase del escaneo"
  
  - name: "‚è∏Ô∏è Escaneo Pausado"
    slug: "escaneo-pausado"
    color: "ff9800"
    description: "Escaneo pausado manualmente"
  
  - name: "üîÑ Re-escaneando"
    slug: "re-escaneando"
    color: "ffc107"
    description: "Re-escaneo en progreso"
  
  # Tags legacy (mantener compatibilidad con c√≥digo existente)
  - name: "Descubierto"
    slug: "descubierto"
    color: "ffc107"
    description: "[LEGACY] Host detectado - usar fase-1-ip-viva"
    
  - name: "Escaneando"
    slug: "escaneando"
    color: "03a9f4"
    description: "[LEGACY] Escaneo en progreso - usar tags de fases"
    
  - name: "Puertos"
    slug: "puertos"
    color: "9c27b0"
    description: "[LEGACY] Puertos detectados - usar fase-2 o fase-3"
    
  - name: "Servicios"
    slug: "servicios"
    color: "00bcd4"
    description: "[LEGACY] Servicios identificados - usar fase-4-servicios"
    
  - name: "Completado"
    slug: "completado"
    color: "4caf50"
    description: "[LEGACY] Escaneo completo - usar fase-5-completado"
    
  - name: "Error"
    slug: "error"
    color: "f44336"
    description: "[LEGACY] Error durante escaneo - usar error-escaneo"

# ============================================================
# IP RANGES (Rangos de IP y su prop√≥sito)
# ============================================================
# Opcional: documentar los rangos sin crear objetos en Netbox
# Esta informaci√≥n se usa en device_classifier.py
ip_ranges:
  infrastructure:
    start: "192.168.3.1"
    end: "192.168.3.9"
    description: "Routers, switches, firewall"
    
  domotica:
    start: "192.168.3.10"
    end: "192.168.3.50"
    description: "Dispositivos IoT y dom√≥tica"
    
  trabajo:
    start: "192.168.3.51"
    end: "192.168.3.150"
    description: "PCs, laptops, servidores"
    
  entretenimiento:
    start: "192.168.3.151"
    end: "192.168.3.254"
    description: "TVs, consolas, streaming"
    
  isp:
    start: "192.168.100.0"
    end: "192.168.100.254"
    description: "Red del ISP"

# ============================================================
# CONFIGURACI√ìN DEL ESCANEO POR FASES
# ============================================================
# Esta secci√≥n documenta la configuraci√≥n del escaneo
# Las variables reales se leen desde .env

scan_phases:
  phase_1_discovery:
    name: "Descubrimiento de IPs"
    techniques:
      - "ICMP Echo (ping)"
      - "TCP SYN a puertos 80,443"
      - "TCP ACK a puertos 80,443"
    nmap_args: "-sn -PS80,443 -PA80,443"
    
  phase_2_tcp_ports:
    name: "Detecci√≥n de Puertos TCP"
    description: "Escaneo SYN completo de todos los puertos TCP"
    nmap_args: "-p- --open -sS --min-rate 5000 -n -Pn"
    output_format: "grepable"
    
  phase_3_udp_ports:
    name: "Detecci√≥n de Puertos UDP"
    description: "Escaneo de puertos UDP comunes"
    nmap_args: "-sU --top-ports 100 -n -Pn"
    
  phase_4_services:
    name: "Identificaci√≥n de Servicios"
    description: "Version detection en puertos abiertos"
    nmap_args: "-sV -Pn"
    dynamic_ports: true  # Usa puertos de fase 2
    
  phase_5_complete:
    name: "Auditor√≠a Completa"
    description: "OS detection, fingerprinting completo"
    nmap_args: "-A -O -sS -sU -sV -Pn"
    requires_sudo: true